{% extends 'userflow/base.html' %}

{% load i18n %}
{% load userflow_gravatar %}
{% load userflow_tags %}

{% block title %}{% trans 'My profile' %}{% endblock %}

{% block content %}
    <div class="ui grid">
        <div class="row">
            <div class="column">
                <div class="ui large breadcrumb">
                    <a href="/" class="section">{% trans 'Main' %}</a>
                    <i class="right chevron icon divider"></i>
                    <a href="{% url 'users:profile:view' %}" class="section">{% trans 'My profile' %}</a>
                    <i class="right chevron icon divider"></i>
                    <div class="active section">{% trans 'Edit' %}</div>
                </div>
            </div>
        </div>
    </div>

    <div class="ui grid">
        <div class="row">
            <div class="three wide column">
                <img class="ui image" src="{% gravatar user.email size=200 default='identicon' %}">
            </div>

            <div class="thirteen wide column">
                <div class="ui horizontal divider" id="personal">{% trans 'Personal info' %}</div>
                {% with form=forms.personal %}
                    {% include 'userflow/forms/profile-personal.html' %}
                {% endwith %}

                <br/>

                <div class="ui horizontal divider" id="about">{% trans 'About' %}</div>
                {% with form=forms.about %}
                    {% include 'userflow/forms/profile-about.html' %}
                {% endwith %}

                <br/>

                <div class="ui horizontal divider" id="password">{% trans 'Password' %}</div>
                {% with form=forms.password %}
                    {% include 'userflow/forms/profile-password.html' %}
                {% endwith %}

                <br/>

                <div class="ui horizontal divider" id="emails">{% trans 'Emails' %}</div>
                {% for email in user.emails.all %}
                    <p>
                        <strong>{{ email.email }}&nbsp;</strong>
                        <a class="ui tiny icon basic button right floated" href="{% url 'users:profile:emails:remove' pk=email.pk %}"><i class="trash icon"></i></a>
                        {% if email.is_active %}
                            <span class="ui green label">{% trans 'Verified' %}</span>
                            {% if email.is_public %}
                                <span class="ui blue label">{% trans 'Public' %}</span>
                                <a class="ui basic tiny button right floated" href="{% url 'users:profile:emails:public' pk=email.pk action='private' %}">{% trans 'Make private' %}</a>
                            {% else %}
                                <span class="ui label">{% trans 'Private' %}</span>
                                <a class="ui basic tiny button right floated" href="{% url 'users:profile:emails:public' pk=email.pk action='public' %}">{% trans 'Make public' %}</a>
                            {% endif %}
                            {% if email.is_primary %}
                                <span class="ui blue label">{% trans 'Primary' %}</span>
                            {% else %}
                                <a class="ui basic tiny button right floated" href="{% url 'users:profile:emails:primary' pk=email.pk %}">{% trans 'Make primary' %}</a>
                            {% endif %}
                        {% else %}
                            <span class="ui orange label">{% trans 'Unverified' %}</span>
                            <a class="ui basic tiny button right floated" href="{% url 'users:profile:emails:verify' pk=email.pk %}">{% trans 'Verify' %}</a>
                        {% endif %}
                    </p>
                {% endfor %}

                <div class="clearfix"></div>

                <a class="ui primary button" href="{% url 'users:profile:emails:add' %}">{% trans 'Add email' %}</a>

                <br/>

                <div class="ui horizontal divider" id="contacts">{% trans 'Contacts' %}</div>
{#                {% with formset=forms.contacts %}#}
{#                    {% include 'userflow/forms/profile-contacts.html' %}#}
{#                {% endwith %}#}

            </div>
        </div>
    </div>

{% endblock %}
